import{j as y}from"./ui-Dwp8H4lk.js";import{a as n,f as x}from"./vendor-CNWCjkky.js";import{aj as w,ak as b,al as I,am as f,an as U,ao as k,D as v,u as A,j as E,f as T,ap as M,t as _,h as Z,l as R,aq as P,p as j,ar as F,as as B}from"./index-debFNmPV.js";import"./animations-DgOVmwgG.js";const h=[{id:"dp_1234567890",amount:125e3,currency:"USD",status:"needs_response",paymentId:"pi_1234567890",reason:"fraudulent",created:new Date("2024-01-15T10:30:00Z"),customer:{id:"cus_abc123",name:"John Doe",email:"john.doe@example.com"},dueBy:new Date("2024-01-22T23:59:59Z"),lastUpdated:new Date("2024-01-15T10:35:00Z")},{id:"dp_0987654321",amount:75e4,currency:"USD",status:"under_review",paymentId:"pi_0987654321",reason:"product_not_received",created:new Date("2024-01-14T15:45:00Z"),customer:{id:"cus_def456",name:"Jane Smith",email:"jane.smith@example.com"},paymentMethod:"Mastercard ••• 5555",description:"Customer claims product was never delivered",transactionId:"txn_0987654321",lastUpdated:new Date("2024-01-14T15:50:00Z"),disputeAmount:75e4,networkReasonCode:"4855"},{id:"dp_1122334455",amount:1500,currency:"USD",status:"won",paymentId:"pi_1122334455",reason:"duplicate",created:new Date("2024-01-13T09:15:00Z"),customer:{id:"cus_ghi789",name:"Bob Johnson",email:"bob.johnson@example.com"},paymentMethod:"Amex ••• 3782",description:"Customer claims duplicate charge",transactionId:"txn_1122334455",lastUpdated:new Date("2024-01-13T10:20:00Z"),disputeAmount:1500,networkReasonCode:"4834"},{id:"dp_5566778899",amount:125e4,currency:"USD",status:"lost",paymentId:"pi_5566778899",reason:"subscription_canceled",created:new Date("2024-01-12T14:20:00Z"),customer:{id:"cus_jkl012",name:"Alice Wilson",email:"alice.wilson@example.com"},paymentMethod:"Visa ••• 1234",description:"Customer claims subscription was canceled before charge",transactionId:"txn_5566778899",lastUpdated:new Date("2024-01-12T15:30:00Z"),disputeAmount:125e4,networkReasonCode:"4841"},{id:"dp_9988776655",amount:5e5,currency:"USD",status:"warning_needs_response",paymentId:"pi_9988776655",reason:"unrecognized",created:new Date("2024-01-11T11:00:00Z"),customer:{id:"cus_mno345",name:"Charlie Brown",email:"charlie.brown@example.com"},paymentMethod:"Apple Pay",description:"Customer doesn't recognize the transaction",evidenceDueBy:new Date("2024-01-18T23:59:59Z"),transactionId:"txn_9988776655",lastUpdated:new Date("2024-01-11T11:05:00Z"),disputeAmount:5e5,networkReasonCode:"4863"},{id:"dp_high_value",amount:25e5,currency:"USD",status:"charge_refunded",paymentId:"pi_large_amount",reason:"product_unacceptable",created:new Date("2024-01-10T16:30:00Z"),customer:{id:"cus_xyz789",name:"Enterprise Client",email:"enterprise@bigcorp.com"},paymentMethod:"Wire Transfer",description:"Enterprise client claims software doesn't meet specifications",transactionId:"txn_large_amount",lastUpdated:new Date("2024-01-10T16:45:00Z"),disputeAmount:25e5,networkReasonCode:"4855"},{id:"dp_international",amount:85e4,currency:"EUR",status:"warning_under_review",paymentId:"pi_international",reason:"credit_not_processed",created:new Date("2024-01-09T08:15:00Z"),customer:{id:"cus_int123",name:"Hans Mueller",email:"hans.mueller@example.de"},paymentMethod:"SEPA Direct Debit",description:"Customer claims promised credit was not applied",transactionId:"txn_international",lastUpdated:new Date("2024-01-09T08:20:00Z"),disputeAmount:85e4,networkReasonCode:"4853"},{id:"dp_mobile",amount:299900,currency:"USD",status:"warning_closed",paymentId:"pi_mobile_payment",reason:"general",created:new Date("2024-01-03T12:15:00Z"),customer:{id:"cus_mobile123",name:"Mobile User",email:"mobile@example.com"},paymentMethod:"Apple Pay",description:"General dispute resolved in merchant's favor",transactionId:"txn_mobile_payment",lastUpdated:new Date("2024-01-03T12:16:00Z"),disputeAmount:299900,networkReasonCode:"4855"},{id:"dp_crypto",amount:5e6,currency:"USD",status:"needs_response",paymentId:"pi_crypto_payment",reason:"fraudulent",created:new Date("2024-01-02T20:30:00Z"),customer:{id:"cus_crypto456",name:"Crypto Enthusiast",email:"crypto@blockchain.com"},paymentMethod:"Bitcoin",description:"High-value crypto transaction disputed as fraudulent",evidenceDueBy:new Date("2024-01-09T23:59:59Z"),transactionId:"txn_crypto_payment",lastUpdated:new Date("2024-01-02T20:35:00Z"),disputeAmount:5e6,networkReasonCode:"4837"},{id:"dp_student",amount:999,currency:"USD",status:"won",paymentId:"pi_student_discount",reason:"subscription_canceled",created:new Date("2023-12-30T14:22:00Z"),customer:{id:"cus_student345",name:"Student User",email:"student@university.edu"},paymentMethod:"Mastercard ••• 1111",description:"Student claims subscription was canceled before billing",transactionId:"txn_student_discount",lastUpdated:new Date("2023-12-30T14:23:00Z"),disputeAmount:999,networkReasonCode:"4841"}],L={amount:I("amount","Amount"),status:b("dispute"),customer:{key:"customer",header:"Customer",width:200,render:e=>y.jsx(f,{maxWidth:200,className:"text-muted-foreground group-hover:text-foreground font-normal",title:e.customer?.email||e.customer?.name||"Unknown",children:e.customer?.email||e.customer?.name||"Unknown"})},reason:{key:"reason",header:"Reason",width:180,render:e=>y.jsx(f,{maxWidth:180,className:"text-muted-foreground group-hover:text-foreground font-normal capitalize",title:e.reason?.replace(/_/g," ")||"Unknown",children:e.reason?.replace(/_/g," ")||"Unknown"})},evidenceDueBy:w("evidenceDueBy","Evidence due",150,!1),created:w("createdAt","Created",180,!1)},S={all:["amount","status","customer","reason","evidenceDueBy","created"]},N=(e="all")=>(S[e]||S.all).map(c=>L[c]).filter(Boolean);function O({data:e=h,selectedDisputes:i=[],onSelectionChange:c=()=>{},onViewDetails:a=()=>{},onSubmitEvidence:d=()=>{},unavailableItems:r=[],loading:m=!1,emptyStateDescription:l="No disputes found."}){const t=n.useMemo(()=>s=>U(s,{onSubmitEvidence:d}),[d]),o=n.useMemo(()=>s=>k(s,{onSubmitEvidence:d}),[d]);return y.jsx(v,{data:e,columns:N(),selectedItems:i,onSelectionChange:c,getItemId:s=>s.id,onRowClick:a,rowActions:t,hoverActions:o,loading:m,unavailableItems:r,emptyStateDescription:l})}const z=({pageSize:e=20,currentPage:i=1,statusFilter:c="all",filters:a={}})=>{const[d,r]=n.useState(!1),[m]=n.useState(null),l=n.useMemo(()=>{let u=[...h];if(c&&c!=="all"&&(u=u.filter(p=>p.status===c)),a.customerName&&typeof a.customerName=="string"){const p=a.customerName.toLowerCase();u=u.filter(g=>g.customer.name.toLowerCase().includes(p)||g.customer.email.toLowerCase().includes(p))}return u},[c,a]),t=n.useMemo(()=>{const u=(i-1)*e,p=u+e;return l.slice(u,p)},[l,i,e]),o=l.length,s=Math.ceil(o/e);n.useEffect(()=>{r(!0);const u=setTimeout(()=>{r(!1)},100);return()=>clearTimeout(u)},[c,a,i]);const D=n.useMemo(()=>{const u=h.reduce((p,g)=>(p[g.status]=(p[g.status]||0)+1,p),{});return{status:Object.entries(u).map(([p,g])=>({value:p,count:g}))}},[]);return{disputes:t,totalItems:o,totalPages:s,isLoading:d,error:m,facets:D}},Q=["all","open","under_review","won","lost"],C=E(M),$=()=>A({statusCardValues:Q,statusMappings:T.getMappings("dispute"),sessionKeys:{statusFilter:"dispute-status-filter",filters:"disputes-filters"},queryUtils:{parseQueryStringToFilters:C.parseQueryStringToFilters,buildQueryString:C.buildQueryString}}),H=()=>{const e=x(),i=n.useCallback(t=>{_.success(`Responding to dispute ${t.id}`)},[]),c=n.useCallback(t=>{_.success(`Dispute ${t.id} accepted`)},[]),a=n.useCallback(t=>{_.success(`Dispute ${t.id} challenged`)},[]),d=n.useCallback(t=>{_.success(`Evidence upload started for dispute ${t.id}`)},[]),r=n.useCallback(t=>{Z(t.id,"Dispute")},[]),m=n.useCallback(t=>{_.success(`Exporting ${t.length} disputes`)},[]),l=n.useCallback(t=>{e(`/disputes/${t.id}`)},[e]);return{respondToDispute:i,acceptDispute:c,challengeDispute:a,uploadEvidence:d,copyDisputeId:r,exportDisputes:m,navigateToDisputeDetails:l}};function q(){const[e,i]=n.useState({disputeDetails:!1,disputeResponse:!1,disputeEvidence:!1}),[c,a]=n.useState(null),d=o=>{a(o),i(s=>({...s,disputeDetails:!0}))},r=o=>{a(o),i(s=>({...s,disputeResponse:!0}))},m=o=>{a(o),i(s=>({...s,disputeEvidence:!0}))},l=o=>{i(s=>({...s,[o]:!1})),Object.values({...e,[o]:!1}).every(s=>!s)&&a(null)};return{selectedDispute:c,openDisputeDetails:d,openDisputeResponse:r,openDisputeEvidence:m,closeSheet:l,getSheetProps:o=>({open:e[o],onOpenChange:s=>{s||l(o)}}),openSheets:e}}function K(){const[e,i]=n.useState(1),[c,a]=n.useState([]),d=R(),r=$(),m=q(),l=H();n.useEffect(()=>{i(1)},[r.statusFilter,r.query,r.tableFilters]);const t=z({pageSize:d.pageSize,currentPage:e,statusFilter:r.statusFilter,filters:r.tableFilters}),o=()=>({selectedItems:c,setSelectedItems:a,hasSelectedItems:c.length>0,handleClearSelection:()=>a([]),batchActionHandlers:{handleBatchExport:D=>{l.exportDisputes(D),a([])}}}),s={header:{title:"Disputes",description:"Manage payment disputes and chargebacks",primaryAction:{label:"Export All",icon:y.jsx(B,{className:"h-4 w-4"}),variant:"outline",onClick:()=>l.exportDisputes([])},secondaryActions:[{label:"Urgent",icon:y.jsx(F,{className:"h-4 w-4"}),variant:"destructive",onClick:()=>r.setStatusFilter("needs_response")}]},statusFilters:T.getFilters("dispute"),table:{component:O,props:{onRowClick:D=>m.openDisputeDetails(D)}},tableFilters:{component:j,props:{entity:"disputes"}},sheets:[]};return y.jsx(P,{...s,useData:()=>({data:t.disputes,isLoading:t.isLoading,totalItems:t.totalItems,totalPages:t.totalPages,pagination:{currentPage:e,pageSize:d.pageSize,totalItems:t.totalItems,totalPages:t.totalPages,onPageChange:i}}),useFilters:()=>r,useSheets:()=>({...m,getSheetProps:D=>{const u=m.getSheetProps(D);return{isOpen:u.open,onClose:()=>u.onOpenChange(!1)}}}),useSelection:o,usePageSize:()=>d,animationKey:r.statusFilter})}export{O as DisputeTable,K as DisputesListPage,H as useDisputeActions,$ as useDisputeFilters,q as useDisputeSheets,z as useDisputes};
